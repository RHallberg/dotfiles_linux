#!/bin/sh
# File rows should be in the following format:
# NAME;URL;ARGS
# %s in URL denotes where query goes
inputfile=~/Documents/data/search_engines/engines.csv

choice=$(awk -F";" '{print $1}' "$inputfile" | dmenu -p "Where to search?")

[ -z "$choice" ] && exit 1

option=$(rg "$choice" "$inputfile")

query=$(dmenu -p "Search $choice" <&-)

[ -z "$query" ] && exit 1

urlencoded=$(echo -n "$query" | jq -sRr @uri)
uri=$(echo "$option" | awk -F";" '{print $2}' | sed "s/%s/$urlencoded/")
args=$(echo "$option" | awk -F";" '{print $3}')
zen-browser "$args" "$uri"
